#= require vendor
#= require_self
#= require_directory ./lib
#= require notification_directive
#= require stops/module

window.Tourganizer =
  Stops: {}
  Config: {}

application = angular.module('tourganizer', ['ngResource', 'ui.date', 'stops'])

application.controller 'appController', ['$scope', '$rootScope', '$q', ($scope, $rootScope, $q) ->
  $rootScope.$on '$routeChangeSuccess', (ev, current, last) ->
    $q.when(current.scope).then =>
      if current.scope.keymap
        $scope.keymap = current.scope.keymap
      else
        $scope.keymap = null
]

application.config ["$httpProvider", "$routeProvider", ($httpProvider, $routeProvider) ->
  $httpProvider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content')
]
